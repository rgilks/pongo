<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Pong</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@700;900&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <h1 class="game-title">PONGO</h1>
    <div id="mainContainer">
      <!-- Game Area -->
      <div id="gameContainer">
        <canvas id="canvas" width="640" height="480"></canvas>

        <div id="countdown"></div>
        <div id="victoryOverlay">
          <div id="victoryText">VICTORY</div>
          <div class="victory-buttons">
            <button id="playAgainBtn">Play Again</button>
            <button id="quitGameBtn" class="btn-quit-overlay">Quit</button>
          </div>
        </div>
      </div>

      <!-- Side/Control Panel with Touch Controls -->
      <div id="sidePanel">
        <!-- Mobile Touch Controls - Left Side -->
        <div class="touch-controls left">
          <button class="touch-btn" data-dir="up">▲</button>
          <button class="touch-btn" data-dir="down">▼</button>
        </div>

        <!-- Single Control Card -->
        <div class="panel-card">
          <div id="scoreRow">
            <div id="scoreContainer">
              <div id="score">0 : 0</div>
            </div>
            <div id="winCondition">First to 5 Wins</div>
          </div>

          <div id="metrics">
            <div class="metric-row">
              <span class="metric-label">FPS</span>
              <span class="metric-value" id="fps">--</span>
            </div>
            <div class="metric-row">
              <span class="metric-label">PING</span>
              <span class="metric-value" id="ping">--</span>
              <span style="font-size: 10px; margin-left: 2px">ms</span>
            </div>
          </div>

          <button id="playBtn" disabled>Play Now</button>

          <!-- Hidden input to store match code -->
          <input type="text" id="matchCode" maxlength="5" />

          <!-- Multiplayer: Create match button -->
          <div id="lobbyControls">
            <button id="createBtn" class="btn-challenge">Challenge a Friend</button>

            <!-- Join with Code -->
            <div class="join-code-container">
              <button id="joinCodeToggle" class="join-code-toggle">Join with Code</button>
              <div id="joinCodeForm" class="join-code-form">
                <input
                  type="text"
                  id="joinCodeInput"
                  class="join-code-input"
                  placeholder="XXXXX"
                  maxlength="5"
                  autocomplete="off"
                  autocapitalize="characters"
                />
                <button id="joinCodeBtn" class="btn-join" disabled>Join Game</button>
              </div>
            </div>
          </div>

          <!-- Quit button for local games -->
          <button id="quitBtn" class="btn-quit" style="display: none">Quit Game</button>
          <!-- Waiting for opponent -->
          <div id="activeMatchControls" style="display: none">
            <div class="waiting-state">
              <!-- Game Code Display with inline buttons -->
              <div class="game-code-display">
                <div class="game-code-label">Game Code</div>
                <div class="game-code-row">
                  <div id="gameCodeDisplay" class="game-code-value">-----</div>
                  <button id="copyCodeBtn" class="btn-icon" title="Copy Code">
                    <svg
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg>
                  </button>
                  <button
                    id="shareLinkBtn"
                    class="btn-icon btn-icon-primary"
                    title="Share"
                    style="display: none"
                  >
                    <svg
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <circle cx="18" cy="5" r="3"></circle>
                      <circle cx="6" cy="12" r="3"></circle>
                      <circle cx="18" cy="19" r="3"></circle>
                      <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                      <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                    </svg>
                  </button>
                </div>
              </div>

              <!-- Hidden input to store share link -->
              <input type="text" id="shareLinkInput" readonly style="display: none" />

              <div
                id="copyFeedback"
                style="
                  font-size: 12px;
                  font-weight: 600;
                  min-height: 18px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  color: var(--accent);
                "
              ></div>

              <button id="leaveBtn" class="btn-leave">Cancel</button>
            </div>
          </div>

          <div class="controls-info">
            CONTROLS<br />
            W / S or ↑ / ↓ to Move
          </div>

          <!-- Ko-fi Support Button -->
          <div style="margin-top: 10px; display: flex; justify-content: center">
            <a href="https://ko-fi.com/N4N31DPNUS" target="_blank" rel="noopener noreferrer">
              <img
                height="34"
                style="border: 0px; height: 34px"
                src="https://storage.ko-fi.com/cdn/kofi2.png?v=6"
                alt="Buy Me a Coffee at ko-fi.com"
              />
            </a>
          </div>
        </div>

        <!-- Mobile Touch Controls - Right Side -->
        <div class="touch-controls right">
          <button class="touch-btn" data-dir="up">▲</button>
          <button class="touch-btn" data-dir="down">▼</button>
        </div>
      </div>
    </div>
    <script type="module" src="script.js"></script>
  </body>
</html>
